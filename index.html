<html>

<head>
  <meta charset="windows-1251">

  <style>
    html {
      font-family: -apple-system,system-ui,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen-Sans,Ubuntu,Cantarell,'Helvetica Neue',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol',sans-serif;
    }

    .container {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .number {
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      width: 50px;
      height: 50px;
      box-shadow: 0 0 1px rgba(0,0,0,0.32), 0 0 2px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.08);
      border-radius: 6px;
      background-color: #f2f2f2;
    }

    .sign {
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      width: 25px;
      height: 25px;
      box-shadow: 0 0 1px rgba(0,0,0,0.32), 0 0 2px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.08);
      border-radius: 6px;
      background-color: #f2f2f2;
    }

    button {
      margin-top: 15px;
      font-size: 20px;
    }

    input {
      font-size: 20px;
      width: 100px;
    }
  </style>
</head>

<body>

<div class="container">
  <div id="firstNumber" class="number"></div>
  <div id="sign" class="sign">X</div>
  <div id="secondNumber" class="number"></div>
  <input id="result" />
</div>
<button id="buttonRun" onclick="run()">Задача</button>

</body>

</html>


<script>
  const setNumbers = new Set();
  let deep = 0;
  let pickedLang;
  const voices = speechSynthesis.getVoices();
	
voices.forEach((voice)=>{
  if(voice.lang === 'ru-Ru'){
    pickedLang = voice;
  }
});

document.getElementById('result').addEventListener('input', onChange);

function getNextNumbers(){
  const a = generateRandomNumber(1, 10);
  const b = generateRandomNumber(1, 10);
  const key = a + '-' + b;

  if(deep > 10){
    return {
      a: 0,
      b: 0,
      stop: true
    }
  }

  if(setNumbers.has(key)){
    deep++;
    return getNextNumbers();
  }

  setNumbers.add(key);

  return {
    a,
    b
  }
}

function run(){
  deep = 0;
  const { a, b, stop } = getNextNumbers();

  if(stop){
    const text = `Похоже ты все решил. Молодец!`;

    const utterance = new SpeechSynthesisUtterance(text);
    //utterance.voice = speechSynthesis.getVoices()[20];
    utterance.voice = pickedLang;
    window.speechSynthesis.speak(utterance);
    return;
  }

  const buttonRun = document.getElementById('buttonRun');
  buttonRun.setAttribute('disabled', true);

	firstNumber.innerHTML = a;
	secondNumber.innerHTML = b;
  document.getElementById('result').value = '';
  document.getElementById('result').focus();

	const text = `Ваня, сколько будет ${a} умножить на ${b}?`;

	const utterance = new SpeechSynthesisUtterance(text);
	//utterance.voice = speechSynthesis.getVoices()[20];
	utterance.voice = pickedLang;
	window.speechSynthesis.speak(utterance);
}


function generateRandomNumber(min, max) {
  const randomNumber = Math.floor(Math.random() * (max - min + 1)) + min;

  return randomNumber;
}

function onChange() {
	const a = parseInt(firstNumber.innerHTML);
	const b = parseInt(secondNumber.innerHTML);
	const result = parseInt(document.getElementById('result').value);

  console.log(a, b, result);

	if(a * b === result){
 		const text = `Правильно`;
		const utterance = new SpeechSynthesisUtterance(text);
		//utterance.voice = speechSynthesis.getVoices()[20];
		utterance.voice = pickedLang;
		window.speechSynthesis.speak(utterance);

    const buttonRun = document.getElementById('buttonRun');

    buttonRun.removeAttribute('disabled');
	}

  if(String(result).length === 2 && a * b !== result){
    const text = `Неправильно, попробуй еще раз`;
    const utterance = new SpeechSynthesisUtterance(text);
    //utterance.voice = speechSynthesis.getVoices()[20];
    utterance.voice = pickedLang;
    window.speechSynthesis.speak(utterance);

    //document.getElementById('result').value = '';
    //document.getElementById('result').focus();

    return;
  }
}
</script>
